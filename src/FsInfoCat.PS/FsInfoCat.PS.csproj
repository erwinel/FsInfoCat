<Project Sdk="Microsoft.NET.Sdk">
    <!-- xmlns="http://schemas.microsoft.com/developer/msbuild/2003" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://schemas.microsoft.com/developer/msbuild/2003 ../../Resources/Build/Microsoft.Build.CommonTypes.xsd" -->
  <PropertyGroup>
    <TargetFramework>netstandard2.1</TargetFramework>
    <AssemblyName>FsInfoCat.PS</AssemblyName>
    <ProjectGuid>{D6A47138-19EF-4860-9C80-64C78EAFDEEE}</ProjectGuid>
    <AssemblyTitle>FS InfoCat PowerShell Library</AssemblyTitle>
    <Description>Supporting CLR Library for PowerShell Module FsInfoCat</Description>
    <Product>PowerShell Module FsInfoCat.PS</Product>
  </PropertyGroup>
  <ItemGroup>
    <ProjectReference Include="..\FsInfoCat\FsInfoCat.csproj" />
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="PowerShellStandard.Library" Version="5.1.0-preview-06" />
    <PackageReference Include="System.ComponentModel.Annotations" Version="5.0.0" />
  </ItemGroup>
  <ItemGroup>
    <_OutputPathItems Include="$(OutputPath)\**\*.*" />
  </ItemGroup>
  <Import Project="$(PsModuleBuildTargets)" />
  <Target Name="PreBuild" AfterTargets="PreBuildEvent">
    <CallTarget Targets="CheckCustomVars" />
  </Target>
  <Target Name="PostBuild" AfterTargets="PostBuildEvent">
    <RemoveDir Directories="$(PsModuleFolder)" />
    <MakeDir Directories="$(PsModuleFolder)" />
    <Copy SourceFiles="@(_OutputPathItems)" DestinationFolder="$(PsModuleFolder)" />
  </Target>
  <Target Name="PostPublish" AfterTargets="Publish">
    <MakeDir Directories="$(DistroFolder)" />
    <Delete Files="$(PsModuleDistroZip)" Condition=" $([System.IO.File]::Exists('$(PsModuleDistroZip)')) " />
    <Message Importance="High" Text="$(MSBuildThisFile): Published module deployed to $(PublishDir)" />
    <Message Importance="High" Text="$(MSBuildThisFile): Creating distributable ZIP file $(PsModuleDistroZip)" />
    <ZipDirectory SourceDirectory="$(PublishDir)" DestinationFile="$(PsModuleDistroZip)" />
  </Target>
</Project>
